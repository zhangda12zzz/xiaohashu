2025-02-10 15:38:12.146 [main] WARN  com.alibaba.nacos.client.logging.NacosLogging - Load Logback Configuration of Nacos fail, message: Could not initialize Logback Nacos logging from classpath:nacos-logback.xml
2025-02-10 15:38:12.181 [main] WARN  com.alibaba.nacos.client.logging.NacosLogging - Load Logback Configuration of Nacos fail, message: Could not initialize Logback Nacos logging from classpath:nacos-logback.xml
2025-02-10 15:38:12.467 [main] WARN  com.alibaba.nacos.client.logging.NacosLogging - Load Logback Configuration of Nacos fail, message: Could not initialize Logback Nacos logging from classpath:nacos-logback.xml
2025-02-10 15:38:12.478 [main] WARN  com.alibaba.nacos.client.logging.NacosLogging - Load Logback Configuration of Nacos fail, message: Could not initialize Logback Nacos logging from classpath:nacos-logback.xml
2025-02-10 15:38:12.478 [main] INFO  c.q.x.comment.biz.XiaohashuCommentBizApplication - The following 1 profile is active: "dev"
2025-02-10 15:38:12.489 [main] WARN  o.s.core.annotation.AnnotationTypeMapping - Support for convention-based annotation attribute overrides is deprecated and will be removed in Spring Framework 6.1. Please annotate the following attributes in @org.springframework.retry.annotation.EnableRetry with appropriate @AliasFor declarations: [proxyTargetClass]
2025-02-10 15:38:13.720 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-02-10 15:38:13.723 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-02-10 15:38:13.741 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 7 ms. Found 0 Redis repository interfaces.
2025-02-10 15:38:13.951 [main] INFO  o.springframework.cloud.context.scope.GenericScope - BeanFactory id=e8a6f41f-15de-3ef0-8e0b-c35da7cc95b3
2025-02-10 15:38:14.079 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'com.quanxiaoha.xiaohashu.kv.api.KeyValueFeignApi' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 15:38:14.080 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'com.quanxiaoha.xiaohashu.user.api.UserFeignApi' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 15:38:14.081 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'com.quanxiaoha.xiaohashu.distributed.id.generator.api.DistributedIdGeneratorFeignApi' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 15:38:15.513 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.rocketmq.spring.autoconfigure.MessageConverterConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.MessageConverterConfiguration$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 15:38:15.708 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'createRocketMQMessageConverter' of type [org.apache.rocketmq.spring.support.RocketMQMessageConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 15:38:15.709 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration' of type [org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 15:38:15.712 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 15:38:15.712 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'loadBalancerClientsDefaultsMappingsProvider' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration$$Lambda$724/0x00000218b5526be8] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 15:38:15.715 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'defaultsBindHandlerAdvisor' of type [org.springframework.cloud.commons.config.DefaultsBindHandlerAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 15:38:15.720 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'rocketmq-org.apache.rocketmq.spring.autoconfigure.RocketMQProperties' of type [org.apache.rocketmq.spring.autoconfigure.RocketMQProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 15:38:15.721 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.rocketmq.spring.autoconfigure.ListenerContainerConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.ListenerContainerConfiguration$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 15:38:16.358 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8093 (http)
2025-02-10 15:38:16.391 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-02-10 15:38:16.392 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.5]
2025-02-10 15:38:16.589 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-02-10 15:38:16.589 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 4099 ms
2025-02-10 15:38:16.851 [main] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-02-10 15:38:17.835 [main] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-02-10 15:38:19.039 [main] INFO  o.s.cloud.openfeign.FeignClientFactoryBean - For 'xiaohashu-kv' URL not provided. Will try picking an instance via load-balancing.
2025-02-10 15:38:19.135 [main] INFO  o.a.r.s.autoconfigure.RocketMQAutoConfiguration - a producer (xiaohashu_group) init on namesrv 127.0.0.1:9876
2025-02-10 15:38:19.570 [main] INFO  o.a.r.s.support.DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='xiaohashu_group_CommentHeatUpdateTopic', namespace='', nameServer='127.0.0.1:9876', topic='CommentHeatUpdateTopic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-02-10 15:38:19.570 [main] INFO  o.a.r.s.a.ListenerContainerConfiguration - Register the listener to container, listenerBeanName:commentHeatUpdateConsumer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_1
2025-02-10 15:38:19.606 [main] INFO  o.a.r.s.support.DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='xiaohashu_group_first_reply_comment_idCountNoteCommentTopic', namespace='', nameServer='127.0.0.1:9876', topic='CountNoteCommentTopic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-02-10 15:38:19.606 [main] INFO  o.a.r.s.a.ListenerContainerConfiguration - Register the listener to container, listenerBeanName:oneLevelCommentFirstReplyCommentIdUpdateConsumer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_2
2025-02-10 15:38:19.755 [main] INFO  o.s.cloud.openfeign.FeignClientFactoryBean - For 'xiaohashu-distributed-id-generator' URL not provided. Will try picking an instance via load-balancing.
2025-02-10 15:38:19.766 [main] INFO  o.s.cloud.openfeign.FeignClientFactoryBean - For 'xiaohashu-user' URL not provided. Will try picking an instance via load-balancing.
2025-02-10 15:38:20.806 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8093 (http) with context path ''
2025-02-10 15:38:20.810 [main] WARN  com.alibaba.nacos.client.logging.NacosLogging - Load Logback Configuration of Nacos fail, message: Could not initialize Logback Nacos logging from classpath:nacos-logback.xml
2025-02-10 15:38:20.810 [main] INFO  com.alibaba.nacos.client.naming - initializer namespace from ans.namespace attribute : null
2025-02-10 15:38:20.811 [main] INFO  com.alibaba.nacos.client.naming - initializer namespace from ALIBABA_ALIWARE_NAMESPACE attribute :null
2025-02-10 15:38:20.811 [main] INFO  com.alibaba.nacos.client.naming - initializer namespace from namespace attribute :null
2025-02-10 15:38:20.825 [main] INFO  com.alibaba.nacos.client.utils.ParamUtil - [settings] [req-serv] nacos-server port:8848
2025-02-10 15:38:20.825 [main] INFO  com.alibaba.nacos.client.utils.ParamUtil - [settings] [http-client] connect timeout:1000
2025-02-10 15:38:20.826 [main] INFO  com.alibaba.nacos.client.utils.ParamUtil - PER_TASK_CONFIG_SIZE: 3000.0
2025-02-10 15:38:20.827 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-02-10 15:38:20.828 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-02-10 15:38:20.829 [main] INFO  c.a.n.client.auth.ram.identify.CredentialWatcher - null No credential found
2025-02-10 15:38:20.835 [main] INFO  com.alibaba.nacos.common.remote.client - [RpcClientFactory] create a new rpc client of 6a3119f9-e3fd-41ec-a2de-963683cd0ce5
2025-02-10 15:38:20.848 [main] INFO  com.alibaba.nacos.common.remote.client - [6a3119f9-e3fd-41ec-a2de-963683cd0ce5] RpcClient init, ServerListFactory = com.alibaba.nacos.client.naming.core.ServerListManager
2025-02-10 15:38:20.848 [main] INFO  com.alibaba.nacos.common.remote.client - [6a3119f9-e3fd-41ec-a2de-963683cd0ce5] Registry connection listener to current client:com.alibaba.nacos.client.naming.remote.gprc.redo.NamingGrpcRedoService
2025-02-10 15:38:20.848 [main] INFO  com.alibaba.nacos.common.remote.client - [6a3119f9-e3fd-41ec-a2de-963683cd0ce5] Register server push request handler:com.alibaba.nacos.client.naming.remote.gprc.NamingPushRequestHandler
2025-02-10 15:38:20.849 [main] INFO  com.alibaba.nacos.common.remote.client - [6a3119f9-e3fd-41ec-a2de-963683cd0ce5] Try to connect to server on start up, server: {serverIp = '127.0.0.1', server main port = 8848}
2025-02-10 15:38:20.866 [main] INFO  c.a.nacos.common.remote.client.grpc.GrpcClient - grpc client connection server:127.0.0.1 ip,serverPort:9848,grpcTslConfig:{"sslProvider":"OPENSSL","enableTls":false,"mutualAuthEnable":false,"trustAll":false}
2025-02-10 15:38:21.488 [main] INFO  com.alibaba.nacos.common.remote.client - [6a3119f9-e3fd-41ec-a2de-963683cd0ce5] Success to connect to server [127.0.0.1:8848] on start up, connectionId = 1739173101331_172.17.0.1_57442
2025-02-10 15:38:21.488 [com.alibaba.nacos.client.remote.worker] INFO  com.alibaba.nacos.common.remote.client - [6a3119f9-e3fd-41ec-a2de-963683cd0ce5] Notify connected event to listeners.
2025-02-10 15:38:21.488 [com.alibaba.nacos.client.remote.worker] INFO  com.alibaba.nacos.client.naming - Grpc connection connect
2025-02-10 15:38:21.489 [main] INFO  com.alibaba.nacos.common.remote.client - [6a3119f9-e3fd-41ec-a2de-963683cd0ce5] Register server push request handler:com.alibaba.nacos.common.remote.client.RpcClient$ConnectResetRequestHandler
2025-02-10 15:38:21.489 [main] INFO  com.alibaba.nacos.common.remote.client - [6a3119f9-e3fd-41ec-a2de-963683cd0ce5] Register server push request handler:com.alibaba.nacos.common.remote.client.RpcClient$$Lambda$1289/0x00000218b59ba510
2025-02-10 15:38:21.490 [main] INFO  com.alibaba.nacos.client.naming - [REGISTER-SERVICE] xiaohashu registering service xiaohashu-comment with instance Instance{instanceId='null', ip='192.168.1.3', port=8093, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={IPv6=[240e:b65:571:db00:75c0:5437:baf6:caaa], preserved.register.source=SPRING_CLOUD}}
2025-02-10 15:38:21.500 [main] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - nacos registry, DEFAULT_GROUP xiaohashu-comment 192.168.1.3:8093 register finished
2025-02-10 15:38:21.621 [main] INFO  c.q.x.comment.biz.XiaohashuCommentBizApplication - Started XiaohashuCommentBizApplication in 10.338 seconds (process running for 10.734)
2025-02-10 15:39:18.487 [http-nio-8093-exec-2] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-02-10 15:39:18.487 [http-nio-8093-exec-2] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-02-10 15:39:18.488 [http-nio-8093-exec-2] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 1 ms
2025-02-10 15:39:18.493 [http-nio-8093-exec-2] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 设置 userId 到 ThreadLocal 中， 用户 ID: 26
2025-02-10 15:39:18.559 [http-nio-8093-exec-2] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求开始: [删除评论], 入参: {"commentId":10001}, 请求类: CommentController, 请求方法: deleteComment =================================== 
2025-02-10 15:39:18.595 [http-nio-8093-exec-2] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==>  Preparing: select id, note_id, user_id, content_uuid, is_content_empty, image_url, `level`, reply_total, like_total, parent_id, reply_comment_id, reply_user_id, is_top, create_time, update_time from t_comment where id = ?
2025-02-10 15:39:19.399 [http-nio-8093-exec-2] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==> Parameters: 10001(Long)
2025-02-10 15:39:19.418 [http-nio-8093-exec-2] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - <==      Total: 1
2025-02-10 15:39:19.421 [http-nio-8093-exec-2] WARN  c.q.x.comment.biz.exception.GlobalExceptionHandler - /comment/delete request fail, errorCode: COMMENT-20004, errorMessage: 您无法操作该评论
2025-02-10 15:39:19.434 [http-nio-8093-exec-2] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 删除 ThreadLocal， userId: 26
2025-02-10 15:39:57.509 [http-nio-8093-exec-1] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 设置 userId 到 ThreadLocal 中， 用户 ID: 26
2025-02-10 15:39:57.510 [http-nio-8093-exec-1] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求开始: [删除评论], 入参: {"commentId":36003}, 请求类: CommentController, 请求方法: deleteComment =================================== 
2025-02-10 15:39:57.510 [http-nio-8093-exec-1] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==>  Preparing: select id, note_id, user_id, content_uuid, is_content_empty, image_url, `level`, reply_total, like_total, parent_id, reply_comment_id, reply_user_id, is_top, create_time, update_time from t_comment where id = ?
2025-02-10 15:39:57.510 [http-nio-8093-exec-1] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==> Parameters: 36003(Long)
2025-02-10 15:39:57.512 [http-nio-8093-exec-1] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - <==      Total: 1
2025-02-10 15:39:57.513 [http-nio-8093-exec-1] WARN  c.q.x.comment.biz.exception.GlobalExceptionHandler - /comment/delete request fail, errorCode: COMMENT-20004, errorMessage: 您无法操作该评论
2025-02-10 15:39:57.513 [http-nio-8093-exec-1] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 删除 ThreadLocal， userId: 26
2025-02-10 15:43:52.973 [http-nio-8093-exec-4] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 设置 userId 到 ThreadLocal 中， 用户 ID: 26
2025-02-10 15:43:52.974 [http-nio-8093-exec-4] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求开始: [删除评论], 入参: {"commentId":28006}, 请求类: CommentController, 请求方法: deleteComment =================================== 
2025-02-10 15:43:52.975 [http-nio-8093-exec-4] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==>  Preparing: select id, note_id, user_id, content_uuid, is_content_empty, image_url, `level`, reply_total, like_total, parent_id, reply_comment_id, reply_user_id, is_top, create_time, update_time from t_comment where id = ?
2025-02-10 15:43:52.976 [http-nio-8093-exec-4] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==> Parameters: 28006(Long)
2025-02-10 15:43:52.978 [http-nio-8093-exec-4] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - <==      Total: 1
2025-02-10 15:43:52.978 [http-nio-8093-exec-4] WARN  c.q.x.comment.biz.exception.GlobalExceptionHandler - /comment/delete request fail, errorCode: COMMENT-20004, errorMessage: 您无法操作该评论
2025-02-10 15:43:52.979 [http-nio-8093-exec-4] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 删除 ThreadLocal， userId: 26
2025-02-10 15:44:13.070 [http-nio-8093-exec-5] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 设置 userId 到 ThreadLocal 中， 用户 ID: 27
2025-02-10 15:44:13.072 [http-nio-8093-exec-5] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求开始: [删除评论], 入参: {"commentId":28006}, 请求类: CommentController, 请求方法: deleteComment =================================== 
2025-02-10 15:44:13.073 [http-nio-8093-exec-5] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==>  Preparing: select id, note_id, user_id, content_uuid, is_content_empty, image_url, `level`, reply_total, like_total, parent_id, reply_comment_id, reply_user_id, is_top, create_time, update_time from t_comment where id = ?
2025-02-10 15:44:13.073 [http-nio-8093-exec-5] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==> Parameters: 28006(Long)
2025-02-10 15:44:13.075 [http-nio-8093-exec-5] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - <==      Total: 1
2025-02-10 15:44:13.081 [http-nio-8093-exec-5] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - ==>  Preparing: delete from t_comment where id = ?
2025-02-10 15:44:13.082 [http-nio-8093-exec-5] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - ==> Parameters: 28006(Long)
2025-02-10 15:44:13.085 [http-nio-8093-exec-5] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - <==    Updates: 1
2025-02-10 15:44:13.092 [http-nio-8093-exec-5] INFO  c.q.f.b.c.interceptor.FeignRequestInterceptor - ########## feign 请求设置请求头 userId: 27
2025-02-10 15:44:13.151 [http-nio-8093-exec-5] INFO  com.alibaba.nacos.client.naming - [SUBSCRIBE-SERVICE] service:xiaohashu-kv, group:DEFAULT_GROUP, clusters: 
2025-02-10 15:44:13.193 [http-nio-8093-exec-5] INFO  com.alibaba.nacos.client.naming - init new ips(1) service: DEFAULT_GROUP@@xiaohashu-kv -> [{"ip":"192.168.1.3","port":8084,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@xiaohashu-kv","metadata":{"preserved.register.source":"SPRING_CLOUD","IPv6":"[240e:b65:571:db00:75c0:5437:baf6:caaa]"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
2025-02-10 15:44:13.201 [http-nio-8093-exec-5] INFO  com.alibaba.nacos.client.naming - current ips:(1) service: DEFAULT_GROUP@@xiaohashu-kv -> [{"ip":"192.168.1.3","port":8084,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@xiaohashu-kv","metadata":{"preserved.register.source":"SPRING_CLOUD","IPv6":"[240e:b65:571:db00:75c0:5437:baf6:caaa]"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
2025-02-10 15:44:13.697 [nacos-grpc-client-executor-127.0.0.1-93] INFO  com.alibaba.nacos.common.remote.client - [6a3119f9-e3fd-41ec-a2de-963683cd0ce5] Receive server push request, request = NotifySubscriberRequest, requestId = 11
2025-02-10 15:44:13.697 [nacos-grpc-client-executor-127.0.0.1-93] INFO  com.alibaba.nacos.common.remote.client - [6a3119f9-e3fd-41ec-a2de-963683cd0ce5] Ack server push request, request = NotifySubscriberRequest, requestId = 11
2025-02-10 15:44:13.974 [http-nio-8093-exec-5] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求结束: [删除评论], 耗时: 902ms, 出参: {"success":true,"message":null,"errorCode":null,"data":null} =================================== 
2025-02-10 15:44:13.976 [http-nio-8093-exec-5] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 删除 ThreadLocal， userId: 27
2025-02-10 15:44:14.009 [NettyClientPublicExecutor_1] INFO  c.q.x.comment.biz.service.impl.CommentServiceImpl - ==> 【删除评论详情本地缓存】MQ 发送成功，SendResult: SendResult [sendStatus=SEND_OK, msgId=7F000001889463947C6B31B9B4A00000, offsetMsgId=AC1AD00100002A9F00000000018DD2E1, messageQueue=MessageQueue [topic=DeleteCommentDetailLocalCacheTopic, brokerName=SK-20231010EQPS, queueId=2], queueOffset=0]
2025-02-10 15:44:14.009 [NettyClientPublicExecutor_2] INFO  c.q.x.comment.biz.service.impl.CommentServiceImpl - ==> 【评论删除】MQ 发送成功，SendResult: SendResult [sendStatus=SEND_OK, msgId=7F000001889463947C6B31B9B4A00001, offsetMsgId=AC1AD00100002A9F00000000018DD400, messageQueue=MessageQueue [topic=DeleteCommentTopic, brokerName=SK-20231010EQPS, queueId=1], queueOffset=0]
2025-02-10 15:47:15.049 [http-nio-8093-exec-7] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 设置 userId 到 ThreadLocal 中， 用户 ID: 27
2025-02-10 15:47:15.055 [http-nio-8093-exec-7] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求开始: [二级评论分页查询], 入参: {"parentCommentId":12003,"pageNo":1}, 请求类: CommentController, 请求方法: findChildCommentPageList =================================== 
2025-02-10 15:47:15.059 [http-nio-8093-exec-7] DEBUG c.q.x.c.b.d.m.C.selectChildCommentTotalById - ==>  Preparing: select child_comment_total from t_comment where id = ? and level = 1
2025-02-10 15:47:15.061 [http-nio-8093-exec-7] DEBUG c.q.x.c.b.d.m.C.selectChildCommentTotalById - ==> Parameters: 12003(Long)
2025-02-10 15:47:15.063 [http-nio-8093-exec-7] DEBUG c.q.x.c.b.d.m.C.selectChildCommentTotalById - <==      Total: 1
2025-02-10 15:47:15.081 [NoteExecutor-2] DEBUG c.q.x.c.b.d.m.C.selectChildCommentsByParentIdAndLimit - ==>  Preparing: select id, create_time from t_comment where parent_id = ? and level = 2 order by create_time asc limit ?
2025-02-10 15:47:15.082 [http-nio-8093-exec-7] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectChildPageList - ==>  Preparing: select id, user_id, note_id, content_uuid, is_content_empty, image_url, like_total, create_time, reply_user_id, parent_id, reply_comment_id from t_comment where parent_id = ? and level = 2 order by id asc limit ?, ?
2025-02-10 15:47:15.091 [http-nio-8093-exec-7] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectChildPageList - ==> Parameters: 12003(Long), 1(Long), 6(Long)
2025-02-10 15:47:15.091 [NoteExecutor-2] DEBUG c.q.x.c.b.d.m.C.selectChildCommentsByParentIdAndLimit - ==> Parameters: 12003(Long), 60(Integer)
2025-02-10 15:47:15.095 [http-nio-8093-exec-7] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectChildPageList - <==      Total: 6
2025-02-10 15:47:15.097 [NoteExecutor-2] DEBUG c.q.x.c.b.d.m.C.selectChildCommentsByParentIdAndLimit - <==      Total: 60
2025-02-10 15:47:15.120 [http-nio-8093-exec-7] INFO  c.q.f.b.c.interceptor.FeignRequestInterceptor - ########## feign 请求设置请求头 userId: 27
2025-02-10 15:47:15.233 [http-nio-8093-exec-7] INFO  c.q.f.b.c.interceptor.FeignRequestInterceptor - ########## feign 请求设置请求头 userId: 27
2025-02-10 15:47:15.246 [http-nio-8093-exec-7] INFO  com.alibaba.nacos.client.naming - [SUBSCRIBE-SERVICE] service:xiaohashu-user, group:DEFAULT_GROUP, clusters: 
2025-02-10 15:47:15.250 [http-nio-8093-exec-7] INFO  com.alibaba.nacos.client.naming - init new ips(0) service: DEFAULT_GROUP@@xiaohashu-user -> []
2025-02-10 15:47:15.250 [http-nio-8093-exec-7] INFO  com.alibaba.nacos.client.naming - current ips:(0) service: DEFAULT_GROUP@@xiaohashu-user -> []
2025-02-10 15:47:15.251 [http-nio-8093-exec-7] WARN  o.s.cloud.loadbalancer.core.RoundRobinLoadBalancer - No servers available for service: xiaohashu-user
2025-02-10 15:47:15.251 [http-nio-8093-exec-7] WARN  o.s.c.o.l.RetryableFeignBlockingLoadBalancerClient - Service instance was not resolved, executing the original request
2025-02-10 15:47:15.775 [nacos-grpc-client-executor-127.0.0.1-132] INFO  com.alibaba.nacos.common.remote.client - [6a3119f9-e3fd-41ec-a2de-963683cd0ce5] Receive server push request, request = NotifySubscriberRequest, requestId = 13
2025-02-10 15:47:15.775 [nacos-grpc-client-executor-127.0.0.1-132] INFO  com.alibaba.nacos.common.remote.client - [6a3119f9-e3fd-41ec-a2de-963683cd0ce5] Ack server push request, request = NotifySubscriberRequest, requestId = 13
2025-02-10 15:47:17.951 [http-nio-8093-exec-7] ERROR c.q.x.comment.biz.exception.GlobalExceptionHandler - /comment/child/list request error, 
feign.RetryableException: xiaohashu-user executing POST http://xiaohashu-user/user/findByIds
	at feign.FeignException.errorExecuting(FeignException.java:277)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:112)
	at feign.SynchronousMethodHandler.invoke(SynchronousMethodHandler.java:72)
	at feign.ReflectiveFeign$FeignInvocationHandler.invoke(ReflectiveFeign.java:98)
	at jdk.proxy2/jdk.proxy2.$Proxy108.findByIds(Unknown Source)
	at com.quanxiaoha.xiaohashu.comment.biz.rpc.UserRpcService.findByIds(UserRpcService.java:42)
	at com.quanxiaoha.xiaohashu.comment.biz.service.impl.CommentServiceImpl.getChildCommentDataAndSync2Redis(CommentServiceImpl.java:1001)
	at com.quanxiaoha.xiaohashu.comment.biz.service.impl.CommentServiceImpl.findChildCommentPageList(CommentServiceImpl.java:457)
	at com.quanxiaoha.xiaohashu.comment.biz.controller.CommentController.findChildCommentPageList(CommentController.java:45)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:89)
	at com.quanxiaoha.framework.biz.operationlog.aspect.ApiOperationLogAspect.doAround(ApiOperationLogAspect.java:53)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:623)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:71)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:173)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:97)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.proceed(CglibAopProxy.java:752)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:703)
	at com.quanxiaoha.xiaohashu.comment.biz.controller.CommentController$$SpringCGLIB$$0.findChildCommentPageList(<generated>)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:207)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:152)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:117)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:884)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:797)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1080)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:973)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1011)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:914)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:547)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:614)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:223)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158)
	at com.quanxiaoha.framework.biz.context.filter.HeaderUserId2ContextFilter.doFilterInternal(HeaderUserId2ContextFilter.java:41)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158)
	at com.alibaba.druid.support.jakarta.WebStatFilter.doFilter(WebStatFilter.java:113)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:185)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:158)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:177)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:119)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:400)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:859)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1734)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1191)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:659)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.base/java.lang.Thread.run(Thread.java:842)
Caused by: java.net.UnknownHostException: xiaohashu-user
	at java.base/sun.nio.ch.NioSocketImpl.connect(NioSocketImpl.java:572)
	at java.base/java.net.Socket.connect(Socket.java:633)
	at java.base/sun.net.NetworkClient.doConnect(NetworkClient.java:178)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:534)
	at java.base/sun.net.www.http.HttpClient.openServer(HttpClient.java:639)
	at java.base/sun.net.www.http.HttpClient.<init>(HttpClient.java:282)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:387)
	at java.base/sun.net.www.http.HttpClient.New(HttpClient.java:409)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:1309)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect0(HttpURLConnection.java:1242)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:1128)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:1057)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream0(HttpURLConnection.java:1451)
	at java.base/sun.net.www.protocol.http.HttpURLConnection.getOutputStream(HttpURLConnection.java:1422)
	at feign.Client$Default.convertAndSend(Client.java:219)
	at feign.Client$Default.execute(Client.java:105)
	at org.springframework.cloud.openfeign.loadbalancer.LoadBalancerUtils.executeWithLoadBalancerLifecycleProcessing(LoadBalancerUtils.java:56)
	at org.springframework.cloud.openfeign.loadbalancer.RetryableFeignBlockingLoadBalancerClient.lambda$execute$2(RetryableFeignBlockingLoadBalancerClient.java:188)
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:329)
	at org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:225)
	at org.springframework.cloud.openfeign.loadbalancer.RetryableFeignBlockingLoadBalancerClient.execute(RetryableFeignBlockingLoadBalancerClient.java:135)
	at feign.SynchronousMethodHandler.executeAndDecode(SynchronousMethodHandler.java:102)
	... 88 common frames omitted
2025-02-10 15:47:17.953 [http-nio-8093-exec-7] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 删除 ThreadLocal， userId: 27
2025-02-10 15:47:50.319 [nacos-grpc-client-executor-127.0.0.1-139] INFO  com.alibaba.nacos.common.remote.client - [6a3119f9-e3fd-41ec-a2de-963683cd0ce5] Receive server push request, request = NotifySubscriberRequest, requestId = 14
2025-02-10 15:47:50.320 [nacos-grpc-client-executor-127.0.0.1-139] INFO  com.alibaba.nacos.client.naming - new ips(1) service: DEFAULT_GROUP@@xiaohashu-user -> [{"ip":"192.168.1.3","port":8082,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@xiaohashu-user","metadata":{"preserved.register.source":"SPRING_CLOUD","IPv6":"[240e:b65:571:db00:75c0:5437:baf6:caaa]"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
2025-02-10 15:47:50.320 [nacos-grpc-client-executor-127.0.0.1-139] INFO  com.alibaba.nacos.client.naming - current ips:(1) service: DEFAULT_GROUP@@xiaohashu-user -> [{"ip":"192.168.1.3","port":8082,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@xiaohashu-user","metadata":{"preserved.register.source":"SPRING_CLOUD","IPv6":"[240e:b65:571:db00:75c0:5437:baf6:caaa]"},"ipDeleteTimeout":30000,"instanceHeartBeatInterval":5000,"instanceHeartBeatTimeOut":15000}]
2025-02-10 15:47:50.320 [nacos-grpc-client-executor-127.0.0.1-139] INFO  com.alibaba.nacos.common.remote.client - [6a3119f9-e3fd-41ec-a2de-963683cd0ce5] Ack server push request, request = NotifySubscriberRequest, requestId = 14
2025-02-10 15:48:14.469 [http-nio-8093-exec-8] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 设置 userId 到 ThreadLocal 中， 用户 ID: 27
2025-02-10 15:48:14.469 [http-nio-8093-exec-8] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求开始: [二级评论分页查询], 入参: {"parentCommentId":12003,"pageNo":1}, 请求类: CommentController, 请求方法: findChildCommentPageList =================================== 
2025-02-10 15:48:14.500 [http-nio-8093-exec-8] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByCommentIds - ==>  Preparing: select id, user_id, content_uuid, is_content_empty, image_url, like_total, is_top, create_time, first_reply_comment_id, child_comment_total, level, parent_id, heat, note_id, reply_comment_id, reply_user_id from t_comment where id in ( ? , ? , ? , ? , ? , ? )
2025-02-10 15:48:14.501 [http-nio-8093-exec-8] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByCommentIds - ==> Parameters: 14003(Long), 14004(Long), 14005(Long), 14006(Long), 14007(Long), 14008(Long)
2025-02-10 15:48:14.505 [http-nio-8093-exec-8] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByCommentIds - <==      Total: 6
2025-02-10 15:48:14.506 [http-nio-8093-exec-8] INFO  c.q.f.b.c.interceptor.FeignRequestInterceptor - ########## feign 请求设置请求头 userId: 27
2025-02-10 15:48:14.516 [http-nio-8093-exec-8] INFO  c.q.f.b.c.interceptor.FeignRequestInterceptor - ########## feign 请求设置请求头 userId: 27
2025-02-10 15:48:14.779 [http-nio-8093-exec-8] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求结束: [二级评论分页查询], 耗时: 309ms, 出参: {"success":true,"message":null,"errorCode":null,"data":[{"commentId":14003,"userId":27,"avatar":"http://127.0.0.1:9000/xiaohashu/46f41e9a32564cd084f3b874a548c16f.jpg","nickname":"犬小哈呀","content":"这是一条测试评论","imageUrl":"","createTime":"01-01","likeTotal":0,"replyUserName":null,"replyUserId":null},{"commentId":14004,"userId":27,"avatar":"http://127.0.0.1:9000/xiaohashu/46f41e9a32564cd084f3b874a548c16f.jpg","nickname":"犬小哈呀","content":"这是一条测试评论","imageUrl":"","createTime":"01-01","likeTotal":0,"replyUserName":null,"replyUserId":null},{"commentId":14005,"userId":27,"avatar":"http://127.0.0.1:9000/xiaohashu/46f41e9a32564cd084f3b874a548c16f.jpg","nickname":"犬小哈呀","content":"这是一条测试评论","imageUrl":"","createTime":"01-01","likeTotal":0,"replyUserName":null,"replyUserId":null},{"commentId":14006,"userId":27,"avatar":"http://127.0.0.1:9000/xiaohashu/46f41e9a32564cd084f3b874a548c16f.jpg","nickname":"犬小哈呀","content":"这是一条测试评论","imageUrl":"","createTime":"01-01","likeTotal":0,"replyUserName":null,"replyUserId":null},{"commentId":14007,"userId":27,"avatar":"http://127.0.0.1:9000/xiaohashu/46f41e9a32564cd084f3b874a548c16f.jpg","nickname":"犬小哈呀","content":"这是一条测试评论","imageUrl":"","createTime":"01-01","likeTotal":0,"replyUserName":null,"replyUserId":null},{"commentId":14008,"userId":27,"avatar":"http://127.0.0.1:9000/xiaohashu/46f41e9a32564cd084f3b874a548c16f.jpg","nickname":"犬小哈呀","content":"这是一条测试评论","imageUrl":"","createTime":"01-01","likeTotal":0,"replyUserName":null,"replyUserId":null}],"pageNo":1,"totalCount":78,"pageSize":6,"totalPage":13} =================================== 
2025-02-10 15:48:14.780 [http-nio-8093-exec-8] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 删除 ThreadLocal， userId: 27
2025-02-10 15:49:30.723 [http-nio-8093-exec-10] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 设置 userId 到 ThreadLocal 中， 用户 ID: 27
2025-02-10 15:49:30.725 [http-nio-8093-exec-10] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求开始: [删除评论], 入参: {"commentId":14004}, 请求类: CommentController, 请求方法: deleteComment =================================== 
2025-02-10 15:49:30.726 [http-nio-8093-exec-10] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==>  Preparing: select id, note_id, user_id, content_uuid, is_content_empty, image_url, `level`, reply_total, like_total, parent_id, reply_comment_id, reply_user_id, is_top, create_time, update_time from t_comment where id = ?
2025-02-10 15:49:30.726 [http-nio-8093-exec-10] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==> Parameters: 14004(Long)
2025-02-10 15:49:30.727 [http-nio-8093-exec-10] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - <==      Total: 1
2025-02-10 15:49:30.728 [http-nio-8093-exec-10] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - ==>  Preparing: delete from t_comment where id = ?
2025-02-10 15:49:30.728 [http-nio-8093-exec-10] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - ==> Parameters: 14004(Long)
2025-02-10 15:49:30.729 [http-nio-8093-exec-10] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - <==    Updates: 1
2025-02-10 15:49:30.730 [http-nio-8093-exec-10] INFO  c.q.f.b.c.interceptor.FeignRequestInterceptor - ########## feign 请求设置请求头 userId: 27
2025-02-10 15:49:30.749 [http-nio-8093-exec-10] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求结束: [删除评论], 耗时: 24ms, 出参: {"success":true,"message":null,"errorCode":null,"data":null} =================================== 
2025-02-10 15:49:30.749 [http-nio-8093-exec-10] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 删除 ThreadLocal， userId: 27
2025-02-10 15:49:30.749 [NettyClientPublicExecutor_3] INFO  c.q.x.comment.biz.service.impl.CommentServiceImpl - ==> 【删除评论详情本地缓存】MQ 发送成功，SendResult: SendResult [sendStatus=SEND_OK, msgId=7F000001889463947C6B31BE89FC0002, offsetMsgId=AC1AD00100002A9F00000000018DD69E, messageQueue=MessageQueue [topic=DeleteCommentDetailLocalCacheTopic, brokerName=SK-20231010EQPS, queueId=1], queueOffset=0]
2025-02-10 15:49:30.749 [NettyClientPublicExecutor_4] INFO  c.q.x.comment.biz.service.impl.CommentServiceImpl - ==> 【评论删除】MQ 发送成功，SendResult: SendResult [sendStatus=SEND_OK, msgId=7F000001889463947C6B31BE89FD0003, offsetMsgId=AC1AD00100002A9F00000000018DD7BD, messageQueue=MessageQueue [topic=DeleteCommentTopic, brokerName=SK-20231010EQPS, queueId=2], queueOffset=0]
2025-02-10 16:37:07.244 [Thread-14] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Start destroying Publisher
2025-02-10 16:37:07.244 [Thread-17] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Start destroying common HttpClient
2025-02-10 16:37:07.244 [Thread-14] WARN  com.alibaba.nacos.common.notify.NotifyCenter - [NotifyCenter] Destruction of the end
2025-02-10 16:37:07.245 [Thread-17] WARN  c.alibaba.nacos.common.http.HttpClientBeanHolder - [HttpClientBeanHolder] Destruction of the end
2025-02-10 16:37:07.249 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[172.26.208.1:10911] result: true
2025-02-10 16:37:07.249 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[127.0.0.1:9876] result: true
2025-02-10 16:37:07.251 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[172.26.208.1:10911] result: true
2025-02-10 16:37:07.251 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[127.0.0.1:9876] result: true
2025-02-10 16:37:07.280 [SpringApplicationShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registering from Nacos Server now...
2025-02-10 16:37:07.280 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.client.naming - [DEREGISTER-SERVICE] xiaohashu deregistering service xiaohashu-comment with instance: Instance{instanceId='null', ip='192.168.1.3', port=8093, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={}}
2025-02-10 16:37:07.282 [SpringApplicationShutdownHook] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - De-registration finished.
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.cache.ServiceInfoHolder do shutdown begin
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.backups.FailoverReactor do shutdown begin
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.backups.FailoverReactor do shutdown stop
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.cache.ServiceInfoHolder do shutdown stop
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate do shutdown begin
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.core.ServiceInfoUpdateService do shutdown begin
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.core.ServiceInfoUpdateService do shutdown stop
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.core.ServerListManager do shutdown begin
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] WARN  com.alibaba.nacos.client.naming - [NamingHttpClientManager] Start destroying NacosRestTemplate
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] WARN  com.alibaba.nacos.client.naming - [NamingHttpClientManager] Destruction of the end
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.core.ServerListManager do shutdown stop
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.remote.http.NamingHttpClientProxy do shutdown begin
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] WARN  com.alibaba.nacos.client.naming - [NamingHttpClientManager] Start destroying NacosRestTemplate
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] WARN  com.alibaba.nacos.client.naming - [NamingHttpClientManager] Destruction of the end
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.remote.http.NamingHttpClientProxy do shutdown stop
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.common.remote.client - Shutdown rpc client, set status to shutdown
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.common.remote.client - Shutdown client event executor java.util.concurrent.ScheduledThreadPoolExecutor@d7e4f0f[Running, pool size = 2, active threads = 2, queued tasks = 0, completed tasks = 0]
2025-02-10 16:37:07.283 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.common.remote.client - Close current connection 1739173101331_172.17.0.1_57442
2025-02-10 16:37:07.286 [nacos-grpc-client-executor-127.0.0.1-740] INFO  c.a.nacos.common.remote.client.grpc.GrpcClient - [1739173101331_172.17.0.1_57442]Ignore complete event,isRunning:false,isAbandon=false
2025-02-10 16:37:07.286 [SpringApplicationShutdownHook] INFO  c.a.nacos.common.remote.client.grpc.GrpcClient - Shutdown grpc executor java.util.concurrent.ThreadPoolExecutor@6d4e9085[Running, pool size = 4, active threads = 0, queued tasks = 0, completed tasks = 741]
2025-02-10 16:37:07.286 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.client.naming - Shutdown grpc redo service executor java.util.concurrent.ScheduledThreadPoolExecutor@100e82bf[Running, pool size = 1, active threads = 0, queued tasks = 1, completed tasks = 1174]
2025-02-10 16:37:07.286 [SpringApplicationShutdownHook] INFO  c.a.n.client.auth.ram.identify.CredentialWatcher - [null] CredentialWatcher is stopped
2025-02-10 16:37:07.286 [SpringApplicationShutdownHook] INFO  c.a.n.client.auth.ram.identify.CredentialService - [null] CredentialService is freed
2025-02-10 16:37:07.286 [SpringApplicationShutdownHook] INFO  com.alibaba.nacos.client.naming - com.alibaba.nacos.client.naming.remote.NamingClientProxyDelegate do shutdown stop
2025-02-10 16:37:07.291 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[172.26.208.1:10911] result: true
2025-02-10 16:37:07.291 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[127.0.0.1:9876] result: true
2025-02-10 16:37:07.293 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[172.26.208.1:10911] result: true
2025-02-10 16:37:07.293 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[127.0.0.1:9876] result: true
2025-02-10 16:37:07.293 [SpringApplicationShutdownHook] INFO  o.a.r.s.support.DefaultRocketMQListenerContainer - container destroyed, DefaultRocketMQListenerContainer{consumerGroup='xiaohashu_group_first_reply_comment_idCountNoteCommentTopic', namespace='', nameServer='127.0.0.1:9876', topic='CountNoteCommentTopic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-02-10 16:37:07.293 [SpringApplicationShutdownHook] INFO  o.a.r.s.support.DefaultRocketMQListenerContainer - container destroyed, DefaultRocketMQListenerContainer{consumerGroup='xiaohashu_group_CommentHeatUpdateTopic', namespace='', nameServer='127.0.0.1:9876', topic='CommentHeatUpdateTopic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-02-10 16:37:07.405 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[172.26.208.1:10911] result: true
2025-02-10 16:37:07.405 [NettyClientSelector_1] INFO  RocketmqRemoting - closeChannel: close the connection to remote address[127.0.0.1:9876] result: true
2025-02-10 16:37:07.407 [SpringApplicationShutdownHook] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} closing ...
2025-02-10 16:37:07.407 [SpringApplicationShutdownHook] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} closed
2025-02-10 20:43:52.070 [main] WARN  com.alibaba.nacos.client.logging.NacosLogging - Load Logback Configuration of Nacos fail, message: Could not initialize Logback Nacos logging from classpath:nacos-logback.xml
2025-02-10 20:43:52.106 [main] WARN  com.alibaba.nacos.client.logging.NacosLogging - Load Logback Configuration of Nacos fail, message: Could not initialize Logback Nacos logging from classpath:nacos-logback.xml
2025-02-10 20:43:52.436 [main] WARN  com.alibaba.nacos.client.logging.NacosLogging - Load Logback Configuration of Nacos fail, message: Could not initialize Logback Nacos logging from classpath:nacos-logback.xml
2025-02-10 20:43:52.444 [main] WARN  com.alibaba.nacos.client.logging.NacosLogging - Load Logback Configuration of Nacos fail, message: Could not initialize Logback Nacos logging from classpath:nacos-logback.xml
2025-02-10 20:43:52.445 [main] INFO  c.q.x.comment.biz.XiaohashuCommentBizApplication - The following 1 profile is active: "dev"
2025-02-10 20:43:52.455 [main] WARN  o.s.core.annotation.AnnotationTypeMapping - Support for convention-based annotation attribute overrides is deprecated and will be removed in Spring Framework 6.1. Please annotate the following attributes in @org.springframework.retry.annotation.EnableRetry with appropriate @AliasFor declarations: [proxyTargetClass]
2025-02-10 20:43:53.313 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
2025-02-10 20:43:53.315 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2025-02-10 20:43:53.331 [main] INFO  o.s.d.r.config.RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 5 ms. Found 0 Redis repository interfaces.
2025-02-10 20:43:53.489 [main] INFO  o.springframework.cloud.context.scope.GenericScope - BeanFactory id=e8a6f41f-15de-3ef0-8e0b-c35da7cc95b3
2025-02-10 20:43:53.521 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'com.quanxiaoha.xiaohashu.kv.api.KeyValueFeignApi' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 20:43:53.522 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'com.quanxiaoha.xiaohashu.user.api.UserFeignApi' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 20:43:53.523 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'com.quanxiaoha.xiaohashu.distributed.id.generator.api.DistributedIdGeneratorFeignApi' of type [org.springframework.cloud.openfeign.FeignClientFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 20:43:53.677 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.rocketmq.spring.autoconfigure.MessageConverterConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.MessageConverterConfiguration$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 20:43:53.715 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'createRocketMQMessageConverter' of type [org.apache.rocketmq.spring.support.RocketMQMessageConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 20:43:53.717 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration' of type [org.springframework.cloud.commons.config.CommonsConfigAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 20:43:53.737 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 20:43:53.738 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'loadBalancerClientsDefaultsMappingsProvider' of type [org.springframework.cloud.client.loadbalancer.LoadBalancerDefaultMappingsProviderAutoConfiguration$$Lambda$726/0x000001e621526fb8] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 20:43:53.739 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'defaultsBindHandlerAdvisor' of type [org.springframework.cloud.commons.config.DefaultsBindHandlerAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 20:43:53.742 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'rocketmq-org.apache.rocketmq.spring.autoconfigure.RocketMQProperties' of type [org.apache.rocketmq.spring.autoconfigure.RocketMQProperties] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 20:43:53.743 [main] INFO  o.s.c.s.PostProcessorRegistrationDelegate$BeanPostProcessorChecker - Bean 'org.apache.rocketmq.spring.autoconfigure.ListenerContainerConfiguration' of type [org.apache.rocketmq.spring.autoconfigure.ListenerContainerConfiguration$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying)
2025-02-10 20:43:54.174 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8093 (http)
2025-02-10 20:43:54.194 [main] INFO  org.apache.catalina.core.StandardService - Starting service [Tomcat]
2025-02-10 20:43:54.195 [main] INFO  org.apache.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.5]
2025-02-10 20:43:54.349 [main] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2025-02-10 20:43:54.349 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 1893 ms
2025-02-10 20:43:54.509 [main] INFO  c.a.d.s.b.a.DruidDataSourceAutoConfigure - Init DruidDataSource
2025-02-10 20:43:55.024 [main] INFO  com.alibaba.druid.pool.DruidDataSource - {dataSource-1} inited
2025-02-10 20:43:55.637 [main] INFO  o.s.cloud.openfeign.FeignClientFactoryBean - For 'xiaohashu-kv' URL not provided. Will try picking an instance via load-balancing.
2025-02-10 20:43:55.680 [main] INFO  o.a.r.s.autoconfigure.RocketMQAutoConfiguration - a producer (xiaohashu_group) init on namesrv 127.0.0.1:9876
2025-02-10 20:43:56.009 [main] INFO  o.a.r.s.support.DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='xiaohashu_group_CommentHeatUpdateTopic', namespace='', nameServer='127.0.0.1:9876', topic='CommentHeatUpdateTopic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-02-10 20:43:56.009 [main] INFO  o.a.r.s.a.ListenerContainerConfiguration - Register the listener to container, listenerBeanName:commentHeatUpdateConsumer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_1
2025-02-10 20:43:56.044 [main] INFO  o.a.r.s.support.DefaultRocketMQListenerContainer - running container: DefaultRocketMQListenerContainer{consumerGroup='xiaohashu_group_first_reply_comment_idCountNoteCommentTopic', namespace='', nameServer='127.0.0.1:9876', topic='CountNoteCommentTopic', consumeMode=CONCURRENTLY, selectorType=TAG, selectorExpression='*', messageModel=CLUSTERING', tlsEnable=false, instanceName=DEFAULT}
2025-02-10 20:43:56.044 [main] INFO  o.a.r.s.a.ListenerContainerConfiguration - Register the listener to container, listenerBeanName:oneLevelCommentFirstReplyCommentIdUpdateConsumer, containerBeanName:org.apache.rocketmq.spring.support.DefaultRocketMQListenerContainer_2
2025-02-10 20:43:56.092 [main] INFO  o.s.cloud.openfeign.FeignClientFactoryBean - For 'xiaohashu-distributed-id-generator' URL not provided. Will try picking an instance via load-balancing.
2025-02-10 20:43:56.102 [main] INFO  o.s.cloud.openfeign.FeignClientFactoryBean - For 'xiaohashu-user' URL not provided. Will try picking an instance via load-balancing.
2025-02-10 20:43:56.820 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8093 (http) with context path ''
2025-02-10 20:43:56.825 [main] WARN  com.alibaba.nacos.client.logging.NacosLogging - Load Logback Configuration of Nacos fail, message: Could not initialize Logback Nacos logging from classpath:nacos-logback.xml
2025-02-10 20:43:56.825 [main] INFO  com.alibaba.nacos.client.naming - initializer namespace from ans.namespace attribute : null
2025-02-10 20:43:56.826 [main] INFO  com.alibaba.nacos.client.naming - initializer namespace from ALIBABA_ALIWARE_NAMESPACE attribute :null
2025-02-10 20:43:56.826 [main] INFO  com.alibaba.nacos.client.naming - initializer namespace from namespace attribute :null
2025-02-10 20:43:56.842 [main] INFO  com.alibaba.nacos.client.utils.ParamUtil - [settings] [req-serv] nacos-server port:8848
2025-02-10 20:43:56.842 [main] INFO  com.alibaba.nacos.client.utils.ParamUtil - [settings] [http-client] connect timeout:1000
2025-02-10 20:43:56.843 [main] INFO  com.alibaba.nacos.client.utils.ParamUtil - PER_TASK_CONFIG_SIZE: 3000.0
2025-02-10 20:43:56.845 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.impl.NacosClientAuthServiceImpl success.
2025-02-10 20:43:56.845 [main] INFO  c.a.n.p.auth.spi.client.ClientAuthPluginManager - [ClientAuthPluginManager] Load ClientAuthService com.alibaba.nacos.client.auth.ram.RamClientAuthServiceImpl success.
2025-02-10 20:43:56.847 [main] INFO  c.a.n.client.auth.ram.identify.CredentialWatcher - null No credential found
2025-02-10 20:43:56.869 [main] INFO  com.alibaba.nacos.common.remote.client - [RpcClientFactory] create a new rpc client of bcd527fd-27dd-418c-9e32-740a327cb664
2025-02-10 20:43:56.938 [main] INFO  com.alibaba.nacos.common.remote.client - [bcd527fd-27dd-418c-9e32-740a327cb664] RpcClient init, ServerListFactory = com.alibaba.nacos.client.naming.core.ServerListManager
2025-02-10 20:43:56.938 [main] INFO  com.alibaba.nacos.common.remote.client - [bcd527fd-27dd-418c-9e32-740a327cb664] Registry connection listener to current client:com.alibaba.nacos.client.naming.remote.gprc.redo.NamingGrpcRedoService
2025-02-10 20:43:56.938 [main] INFO  com.alibaba.nacos.common.remote.client - [bcd527fd-27dd-418c-9e32-740a327cb664] Register server push request handler:com.alibaba.nacos.client.naming.remote.gprc.NamingPushRequestHandler
2025-02-10 20:43:56.939 [main] INFO  com.alibaba.nacos.common.remote.client - [bcd527fd-27dd-418c-9e32-740a327cb664] Try to connect to server on start up, server: {serverIp = '127.0.0.1', server main port = 8848}
2025-02-10 20:43:56.959 [main] INFO  c.a.nacos.common.remote.client.grpc.GrpcClient - grpc client connection server:127.0.0.1 ip,serverPort:9848,grpcTslConfig:{"sslProvider":"OPENSSL","enableTls":false,"mutualAuthEnable":false,"trustAll":false}
2025-02-10 20:43:59.550 [main] INFO  com.alibaba.nacos.common.remote.client - [bcd527fd-27dd-418c-9e32-740a327cb664] Success to connect to server [127.0.0.1:8848] on start up, connectionId = 1739191439333_172.17.0.1_49854
2025-02-10 20:43:59.550 [com.alibaba.nacos.client.remote.worker] INFO  com.alibaba.nacos.common.remote.client - [bcd527fd-27dd-418c-9e32-740a327cb664] Notify connected event to listeners.
2025-02-10 20:43:59.550 [com.alibaba.nacos.client.remote.worker] INFO  com.alibaba.nacos.client.naming - Grpc connection connect
2025-02-10 20:43:59.550 [main] INFO  com.alibaba.nacos.common.remote.client - [bcd527fd-27dd-418c-9e32-740a327cb664] Register server push request handler:com.alibaba.nacos.common.remote.client.RpcClient$ConnectResetRequestHandler
2025-02-10 20:43:59.550 [main] INFO  com.alibaba.nacos.common.remote.client - [bcd527fd-27dd-418c-9e32-740a327cb664] Register server push request handler:com.alibaba.nacos.common.remote.client.RpcClient$$Lambda$1291/0x000001e6219b8440
2025-02-10 20:43:59.551 [main] INFO  com.alibaba.nacos.client.naming - [REGISTER-SERVICE] xiaohashu registering service xiaohashu-comment with instance Instance{instanceId='null', ip='192.168.1.3', port=8093, weight=1.0, healthy=true, enabled=true, ephemeral=true, clusterName='DEFAULT', serviceName='null', metadata={IPv6=[240e:b65:571:db00:75c0:5437:baf6:caaa], preserved.register.source=SPRING_CLOUD}}
2025-02-10 20:43:59.605 [main] INFO  c.a.cloud.nacos.registry.NacosServiceRegistry - nacos registry, DEFAULT_GROUP xiaohashu-comment 192.168.1.3:8093 register finished
2025-02-10 20:43:59.718 [main] INFO  c.q.x.comment.biz.XiaohashuCommentBizApplication - Started XiaohashuCommentBizApplication in 8.542 seconds (process running for 9.98)
2025-02-10 20:44:29.412 [http-nio-8093-exec-1] INFO  o.a.c.core.ContainerBase.[Tomcat].[localhost].[/] - Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-02-10 20:44:29.413 [http-nio-8093-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Initializing Servlet 'dispatcherServlet'
2025-02-10 20:44:29.413 [http-nio-8093-exec-1] INFO  org.springframework.web.servlet.DispatcherServlet - Completed initialization in 0 ms
2025-02-10 20:44:29.418 [http-nio-8093-exec-1] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 设置 userId 到 ThreadLocal 中， 用户 ID: 27
2025-02-10 20:44:29.493 [http-nio-8093-exec-1] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求开始: [删除评论], 入参: {"commentId":28005}, 请求类: CommentController, 请求方法: deleteComment =================================== 
2025-02-10 20:44:29.510 [http-nio-8093-exec-1] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==>  Preparing: select id, note_id, user_id, content_uuid, is_content_empty, image_url, `level`, reply_total, like_total, parent_id, reply_comment_id, reply_user_id, is_top, create_time, update_time from t_comment where id = ?
2025-02-10 20:44:30.055 [http-nio-8093-exec-1] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==> Parameters: 28005(Long)
2025-02-10 20:44:30.069 [http-nio-8093-exec-1] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - <==      Total: 1
2025-02-10 20:44:30.073 [http-nio-8093-exec-1] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - ==>  Preparing: delete from t_comment where id = ?
2025-02-10 20:44:30.074 [http-nio-8093-exec-1] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - ==> Parameters: 28005(Long)
2025-02-10 20:44:30.077 [http-nio-8093-exec-1] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - <==    Updates: 1
2025-02-10 20:44:30.084 [http-nio-8093-exec-1] INFO  c.q.f.b.c.interceptor.FeignRequestInterceptor - ########## feign 请求设置请求头 userId: 27
2025-02-10 20:44:30.137 [http-nio-8093-exec-1] INFO  com.alibaba.nacos.client.naming - [SUBSCRIBE-SERVICE] service:xiaohashu-kv, group:DEFAULT_GROUP, clusters: 
2025-02-10 20:44:30.147 [http-nio-8093-exec-1] INFO  com.alibaba.nacos.client.naming - init new ips(1) service: DEFAULT_GROUP@@xiaohashu-kv -> [{"ip":"192.168.1.3","port":8084,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@xiaohashu-kv","metadata":{"preserved.register.source":"SPRING_CLOUD","IPv6":"[240e:b65:571:db00:75c0:5437:baf6:caaa]"},"ipDeleteTimeout":30000,"instanceHeartBeatTimeOut":15000,"instanceHeartBeatInterval":5000}]
2025-02-10 20:44:30.152 [http-nio-8093-exec-1] INFO  com.alibaba.nacos.client.naming - current ips:(1) service: DEFAULT_GROUP@@xiaohashu-kv -> [{"ip":"192.168.1.3","port":8084,"weight":1.0,"healthy":true,"enabled":true,"ephemeral":true,"clusterName":"DEFAULT","serviceName":"DEFAULT_GROUP@@xiaohashu-kv","metadata":{"preserved.register.source":"SPRING_CLOUD","IPv6":"[240e:b65:571:db00:75c0:5437:baf6:caaa]"},"ipDeleteTimeout":30000,"instanceHeartBeatTimeOut":15000,"instanceHeartBeatInterval":5000}]
2025-02-10 20:44:30.656 [nacos-grpc-client-executor-127.0.0.1-21] INFO  com.alibaba.nacos.common.remote.client - [bcd527fd-27dd-418c-9e32-740a327cb664] Receive server push request, request = NotifySubscriberRequest, requestId = 16
2025-02-10 20:44:30.657 [nacos-grpc-client-executor-127.0.0.1-21] INFO  com.alibaba.nacos.common.remote.client - [bcd527fd-27dd-418c-9e32-740a327cb664] Ack server push request, request = NotifySubscriberRequest, requestId = 16
2025-02-10 20:44:30.713 [http-nio-8093-exec-1] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求结束: [删除评论], 耗时: 1222ms, 出参: {"success":true,"message":null,"errorCode":null,"data":null} =================================== 
2025-02-10 20:44:30.719 [http-nio-8093-exec-1] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 删除 ThreadLocal， userId: 27
2025-02-10 20:44:30.728 [NettyClientPublicExecutor_2] INFO  c.q.x.comment.biz.service.impl.CommentServiceImpl - ==> 【评论删除】MQ 发送成功，SendResult: SendResult [sendStatus=SEND_OK, msgId=7F0000012CE863947C6B32CC9E810001, offsetMsgId=AC1AD00100002A9F00000000018DDA52, messageQueue=MessageQueue [topic=DeleteCommentTopic, brokerName=SK-20231010EQPS, queueId=2], queueOffset=1]
2025-02-10 20:44:30.728 [NettyClientPublicExecutor_1] INFO  c.q.x.comment.biz.service.impl.CommentServiceImpl - ==> 【删除评论详情本地缓存】MQ 发送成功，SendResult: SendResult [sendStatus=SEND_OK, msgId=7F0000012CE863947C6B32CC9E810000, offsetMsgId=AC1AD00100002A9F00000000018DDCE7, messageQueue=MessageQueue [topic=DeleteCommentDetailLocalCacheTopic, brokerName=SK-20231010EQPS, queueId=3], queueOffset=0]
2025-02-10 20:44:39.716 [http-nio-8093-exec-2] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 设置 userId 到 ThreadLocal 中， 用户 ID: 27
2025-02-10 20:44:39.717 [http-nio-8093-exec-2] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求开始: [删除评论], 入参: {"commentId":28004}, 请求类: CommentController, 请求方法: deleteComment =================================== 
2025-02-10 20:44:39.717 [http-nio-8093-exec-2] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==>  Preparing: select id, note_id, user_id, content_uuid, is_content_empty, image_url, `level`, reply_total, like_total, parent_id, reply_comment_id, reply_user_id, is_top, create_time, update_time from t_comment where id = ?
2025-02-10 20:44:39.718 [http-nio-8093-exec-2] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==> Parameters: 28004(Long)
2025-02-10 20:44:39.721 [http-nio-8093-exec-2] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - <==      Total: 1
2025-02-10 20:44:39.722 [http-nio-8093-exec-2] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - ==>  Preparing: delete from t_comment where id = ?
2025-02-10 20:44:39.722 [http-nio-8093-exec-2] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - ==> Parameters: 28004(Long)
2025-02-10 20:44:39.723 [http-nio-8093-exec-2] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - <==    Updates: 1
2025-02-10 20:44:39.724 [http-nio-8093-exec-2] INFO  c.q.f.b.c.interceptor.FeignRequestInterceptor - ########## feign 请求设置请求头 userId: 27
2025-02-10 20:44:39.747 [http-nio-8093-exec-2] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求结束: [删除评论], 耗时: 30ms, 出参: {"success":true,"message":null,"errorCode":null,"data":null} =================================== 
2025-02-10 20:44:39.747 [http-nio-8093-exec-2] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 删除 ThreadLocal， userId: 27
2025-02-10 20:44:39.749 [NettyClientPublicExecutor_3] INFO  c.q.x.comment.biz.service.impl.CommentServiceImpl - ==> 【评论删除】MQ 发送成功，SendResult: SendResult [sendStatus=SEND_OK, msgId=7F0000012CE863947C6B32CCC1C30003, offsetMsgId=AC1AD00100002A9F00000000018DDE06, messageQueue=MessageQueue [topic=DeleteCommentTopic, brokerName=SK-20231010EQPS, queueId=2], queueOffset=2]
2025-02-10 20:44:39.749 [NettyClientPublicExecutor_4] INFO  c.q.x.comment.biz.service.impl.CommentServiceImpl - ==> 【删除评论详情本地缓存】MQ 发送成功，SendResult: SendResult [sendStatus=SEND_OK, msgId=7F0000012CE863947C6B32CCC1C30002, offsetMsgId=AC1AD00100002A9F00000000018DE09B, messageQueue=MessageQueue [topic=DeleteCommentDetailLocalCacheTopic, brokerName=SK-20231010EQPS, queueId=2], queueOffset=1]
2025-02-10 20:44:47.914 [http-nio-8093-exec-4] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 设置 userId 到 ThreadLocal 中， 用户 ID: 27
2025-02-10 20:44:47.914 [http-nio-8093-exec-4] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求开始: [删除评论], 入参: {"commentId":28002}, 请求类: CommentController, 请求方法: deleteComment =================================== 
2025-02-10 20:44:47.914 [http-nio-8093-exec-4] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==>  Preparing: select id, note_id, user_id, content_uuid, is_content_empty, image_url, `level`, reply_total, like_total, parent_id, reply_comment_id, reply_user_id, is_top, create_time, update_time from t_comment where id = ?
2025-02-10 20:44:47.915 [http-nio-8093-exec-4] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==> Parameters: 28002(Long)
2025-02-10 20:44:47.916 [http-nio-8093-exec-4] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - <==      Total: 1
2025-02-10 20:44:47.917 [http-nio-8093-exec-4] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - ==>  Preparing: delete from t_comment where id = ?
2025-02-10 20:44:47.917 [http-nio-8093-exec-4] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - ==> Parameters: 28002(Long)
2025-02-10 20:44:47.919 [http-nio-8093-exec-4] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - <==    Updates: 1
2025-02-10 20:44:47.919 [http-nio-8093-exec-4] INFO  c.q.f.b.c.interceptor.FeignRequestInterceptor - ########## feign 请求设置请求头 userId: 27
2025-02-10 20:44:47.937 [http-nio-8093-exec-4] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求结束: [删除评论], 耗时: 23ms, 出参: {"success":true,"message":null,"errorCode":null,"data":null} =================================== 
2025-02-10 20:44:47.937 [http-nio-8093-exec-4] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 删除 ThreadLocal， userId: 27
2025-02-10 20:44:47.938 [NettyClientPublicExecutor_5] INFO  c.q.x.comment.biz.service.impl.CommentServiceImpl - ==> 【删除评论详情本地缓存】MQ 发送成功，SendResult: SendResult [sendStatus=SEND_OK, msgId=7F0000012CE863947C6B32CCE1C10004, offsetMsgId=AC1AD00100002A9F00000000018DE1BA, messageQueue=MessageQueue [topic=DeleteCommentDetailLocalCacheTopic, brokerName=SK-20231010EQPS, queueId=0], queueOffset=0]
2025-02-10 20:44:47.938 [NettyClientPublicExecutor_6] INFO  c.q.x.comment.biz.service.impl.CommentServiceImpl - ==> 【评论删除】MQ 发送成功，SendResult: SendResult [sendStatus=SEND_OK, msgId=7F0000012CE863947C6B32CCE1C10005, offsetMsgId=AC1AD00100002A9F00000000018DE2D9, messageQueue=MessageQueue [topic=DeleteCommentTopic, brokerName=SK-20231010EQPS, queueId=3], queueOffset=0]
2025-02-10 20:44:56.842 [http-nio-8093-exec-5] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 设置 userId 到 ThreadLocal 中， 用户 ID: 27
2025-02-10 20:44:56.842 [http-nio-8093-exec-5] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求开始: [删除评论], 入参: {"commentId":28001}, 请求类: CommentController, 请求方法: deleteComment =================================== 
2025-02-10 20:44:56.843 [http-nio-8093-exec-5] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==>  Preparing: select id, note_id, user_id, content_uuid, is_content_empty, image_url, `level`, reply_total, like_total, parent_id, reply_comment_id, reply_user_id, is_top, create_time, update_time from t_comment where id = ?
2025-02-10 20:44:56.843 [http-nio-8093-exec-5] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - ==> Parameters: 28001(Long)
2025-02-10 20:44:56.846 [http-nio-8093-exec-5] DEBUG c.q.x.c.b.d.m.CommentDOMapper.selectByPrimaryKey - <==      Total: 1
2025-02-10 20:44:56.847 [http-nio-8093-exec-5] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - ==>  Preparing: delete from t_comment where id = ?
2025-02-10 20:44:56.847 [http-nio-8093-exec-5] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - ==> Parameters: 28001(Long)
2025-02-10 20:44:56.849 [http-nio-8093-exec-5] DEBUG c.q.x.c.b.d.m.CommentDOMapper.deleteByPrimaryKey - <==    Updates: 1
2025-02-10 20:44:56.849 [http-nio-8093-exec-5] INFO  c.q.f.b.c.interceptor.FeignRequestInterceptor - ########## feign 请求设置请求头 userId: 27
2025-02-10 20:44:56.870 [http-nio-8093-exec-5] INFO  c.q.f.b.operationlog.aspect.ApiOperationLogAspect - ====== 请求结束: [删除评论], 耗时: 28ms, 出参: {"success":true,"message":null,"errorCode":null,"data":null} =================================== 
2025-02-10 20:44:56.870 [NettyClientPublicExecutor_7] INFO  c.q.x.comment.biz.service.impl.CommentServiceImpl - ==> 【删除评论详情本地缓存】MQ 发送成功，SendResult: SendResult [sendStatus=SEND_OK, msgId=7F0000012CE863947C6B32CD04A50006, offsetMsgId=AC1AD00100002A9F00000000018DE577, messageQueue=MessageQueue [topic=DeleteCommentDetailLocalCacheTopic, brokerName=SK-20231010EQPS, queueId=0], queueOffset=1]
2025-02-10 20:44:56.870 [NettyClientPublicExecutor_8] INFO  c.q.x.comment.biz.service.impl.CommentServiceImpl - ==> 【评论删除】MQ 发送成功，SendResult: SendResult [sendStatus=SEND_OK, msgId=7F0000012CE863947C6B32CD04A60007, offsetMsgId=AC1AD00100002A9F00000000018DE696, messageQueue=MessageQueue [topic=DeleteCommentTopic, brokerName=SK-20231010EQPS, queueId=2], queueOffset=3]
2025-02-10 20:44:56.870 [http-nio-8093-exec-5] INFO  c.q.f.b.context.filter.HeaderUserId2ContextFilter - ===== 删除 ThreadLocal， userId: 27
